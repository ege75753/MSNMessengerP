<Window x:Class="MSNClient.BlackjackWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ðŸƒ Blackjack" Height="660" Width="820"
        MinHeight="540" MinWidth="700"
        Background="#071022" FontFamily="Tahoma"
        WindowStartupLocation="CenterOwner"
        Closing="Window_Closing">

    <Window.Resources>
        <Style x:Key="ChipBtn" TargetType="Button">
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="46"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="3"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Ellipse Fill="{TemplateBinding Background}" Stroke="{TemplateBinding BorderBrush}"
                                     StrokeThickness="3"/>
                            <Ellipse Stroke="White" StrokeThickness="1" Margin="6"/>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.85"/>
                                <Setter Property="RenderTransform">
                                    <Setter.Value><ScaleTransform ScaleX="1.08" ScaleY="1.08"/></Setter.Value>
                                </Setter>
                                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.3"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GameBtn" TargetType="Button">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,7"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd" Background="{TemplateBinding Background}"
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="bd" Property="Opacity" Value="0.82"/></Trigger>
                            <Trigger Property="IsEnabled" Value="False"><Setter TargetName="bd" Property="Opacity" Value="0.3"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#05101A" Padding="14,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock x:Name="TitleText" Text="ðŸƒ Blackjack" FontSize="15"
                               FontWeight="Bold" Foreground="#FFD700"/>
                    <TextBlock x:Name="StatusText" FontSize="10" Foreground="#7EAABB"/>
                </StackPanel>
                <StackPanel x:Name="ScoresPanel" Grid.Column="1" Orientation="Horizontal"
                            VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Table Canvas (main area) -->
        <Canvas Grid.Row="1" x:Name="TableCanvas" Background="#0A1628" ClipToBounds="True"
                SizeChanged="TableCanvas_SizeChanged"/>

        <!-- Action footer -->
        <Border Grid.Row="2" Background="#05101A" Padding="10,9">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Lobby panel (pre-game) -->
                <StackPanel x:Name="LobbyPanel" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="LobbyStatusText" FontSize="11" Foreground="#7EAABB"
                               VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <Button x:Name="StartBtn" Content="â–¶  Start Game" Background="#2E8B2E"
                            Style="{StaticResource GameBtn}" Visibility="Collapsed" Click="Start_Click"/>
                </StackPanel>

                <!-- Betting panel -->
                <StackPanel x:Name="BettingPanel" Orientation="Horizontal" VerticalAlignment="Center" Visibility="Collapsed">
                    <TextBlock Text="Your bet:" FontSize="11" Foreground="#AAB" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <TextBlock x:Name="BetAmountText" Text="$0" FontSize="15" FontWeight="Bold"
                               Foreground="#FFD700" VerticalAlignment="Center" Margin="0,0,6,0" MinWidth="50"/>
                    <!-- Live chip preview (one circle per chip clicked) -->
                    <WrapPanel x:Name="ChipPreviewPanel" Orientation="Horizontal"
                               VerticalAlignment="Center" Margin="0,0,8,0" MaxWidth="120"/>
                    <!-- Chip buttons -->
                    <Button Tag="5"   Content="$5"   Background="#C0392B" BorderBrush="#FF8070" Style="{StaticResource ChipBtn}" Click="Chip_Click" Margin="3,0"/>
                    <Button Tag="10"  Content="$10"  Background="#1A6BB5" BorderBrush="#70B0FF" Style="{StaticResource ChipBtn}" Click="Chip_Click" Margin="3,0"/>
                    <Button Tag="25"  Content="$25"  Background="#27AE60" BorderBrush="#70EF90" Style="{StaticResource ChipBtn}" Click="Chip_Click" Margin="3,0"/>
                    <Button Tag="50"  Content="$50"  Background="#7B2D8B" BorderBrush="#C080E0" Style="{StaticResource ChipBtn}" Click="Chip_Click" Margin="3,0"/>
                    <Button Tag="100" Content="$100" Background="#E67E22" BorderBrush="#FFB060" Style="{StaticResource ChipBtn}" Click="Chip_Click" Margin="3,0"/>
                    <Button Content="âœ•" Background="#444" Style="{StaticResource ChipBtn}" Click="BetClear_Click" Margin="6,0,0,0" BorderBrush="#888" Width="34" Height="34" FontSize="14"/>
                    <Button x:Name="DealMeInBtn" Content="âœ…  Deal Me In" Background="#1E6B3C"
                            Style="{StaticResource GameBtn}" Click="DealMeIn_Click" Margin="10,0,0,0"/>
                </StackPanel>

                <!-- In-game action panel -->
                <StackPanel x:Name="ActionPanel" Orientation="Horizontal" VerticalAlignment="Center" Visibility="Collapsed">
                    <TextBlock x:Name="TurnText" FontSize="12" Foreground="#7EE890"
                               VerticalAlignment="Center" Margin="0,0,16,0"/>
                    <Button x:Name="HitBtn" Content="ðŸ‘†  Hit" Background="#2E8B57"
                            Style="{StaticResource GameBtn}" Click="Hit_Click" IsEnabled="False"/>
                    <Button x:Name="StandBtn" Content="âœ‹  Stand" Background="#A32020"
                            Style="{StaticResource GameBtn}" Click="Stand_Click" IsEnabled="False"/>
                </StackPanel>

                <!-- Right: persistent controls -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="NextRoundBtn" Content="ðŸ”„  Next Round" Background="#20508B"
                            Style="{StaticResource GameBtn}" Visibility="Collapsed" Click="NextRound_Click"/>
                    <Button Content="ðŸšª  Leave" Background="#3A3A3A"
                            Style="{StaticResource GameBtn}" Click="Leave_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
